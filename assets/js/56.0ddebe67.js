(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{315:function(e,s,t){"use strict";t.r(s);var a=t(28),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"tree-shaking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[e._v("#")]),e._v(" Tree Shaking")]),e._v(" "),t("p",[t("strong",[e._v("通常用于描述移除 JavaScript 上下文中的未引用代码（dead-code）。它依赖于 ES2015 模块语法的静态结构特性，如 "),t("code",[e._v("import")]),e._v(" 和 "),t("code",[e._v("export")]),e._v("。")])]),e._v(" "),t("h2",{attrs:{id:"将文件标记为-side-effect-free（无副作用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将文件标记为-side-effect-free（无副作用）"}},[e._v("#")]),e._v(" 将文件标记为 side-effect-free（无副作用）")]),e._v(" "),t("p",[e._v("通过 package.json 的 "),t("code",[e._v("sideEffects")]),e._v(" 属性来识别出哪些文件有 side effect。")]),e._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"your-project"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"sideEffects"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[e._v("若所有代码都不含 side effect，可将该属性标记为 "),t("code",[e._v("false")]),e._v("，以此告诉 webpack 可以安全地删除未用到的 export。")]),e._v(" "),t("p",[e._v("若代码中有副作用，可改为提供一个数组：")]),e._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"your-project"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[e._v('"sideEffects"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"./src/some-side-effectful-file.js"')]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("h2",{attrs:{id:"结论"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[e._v("#")]),e._v(" 结论")]),e._v(" "),t("p",[e._v("为了利用 tree shaking 的优势，必须：")]),e._v(" "),t("ul",[t("li",[e._v("使用 ES2015 模块语法（即 "),t("code",[e._v("import")]),e._v(" 和 "),t("code",[e._v("export")]),e._v("）；")]),e._v(" "),t("li",[e._v("确保没有编译器将您的 ES2015 模块语法转换为 CommonJS 的（顺带一提，这是现在常用的 @babel/preset-env 的默认行为）；")]),e._v(" "),t("li",[e._v("在项目的 "),t("code",[e._v("package.json")]),e._v(" 文件中，添加 "),t("code",[e._v("sideEffects")]),e._v(" 属性，手动指定有副作用的脚本；")]),e._v(" "),t("li",[e._v("使用 "),t("code",[e._v("mode")]),e._v(" 为 "),t("code",[e._v("production")]),e._v(" 的配置项来启用更多优化项，包括压缩代码与 tree shaking。")])]),e._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[e._v("#")]),e._v(" 参考文章")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://webpack.docschina.org/guides/tree-shaking/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tree Shaking"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/43844419",target:"_blank",rel:"noopener noreferrer"}},[e._v("浅谈 ES 模块和 Webpack Tree-shaking"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://twindy.org/qian-xi-tree-shakinggong-zuo-yuan-li/",target:"_blank",rel:"noopener noreferrer"}},[e._v("浅谈tree shaking工作原理"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);