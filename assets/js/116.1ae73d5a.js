(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{223:function(t,a,s){"use strict";s.r(a);var r=s(28),e=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#前端错误异常按照捕获方式分类"}},[t._v("前端错误异常按照捕获方式分类")])]),s("li",[s("a",{attrs:{href:"#try-catch"}},[t._v("try...catch")])]),s("li",[s("a",{attrs:{href:"#window-onerror"}},[t._v("window.onerror")])]),s("li",[s("a",{attrs:{href:"#window-addeventlistener"}},[t._v("window.addEventListener")]),s("ul",[s("li",[s("a",{attrs:{href:"#error-事件捕获资源加载错误"}},[t._v("error 事件捕获资源加载错误")])]),s("li",[s("a",{attrs:{href:"#unhandledrejection事件捕获promise异常"}},[t._v("unhandledrejection事件捕获Promise异常")])])])]),s("li",[s("a",{attrs:{href:"#promise-then-catch"}},[t._v("Promise.then().catch")])]),s("li",[s("a",{attrs:{href:"#封装xmlhttprequest-fetch-覆写请求接口对象"}},[t._v("封装XMLHttpRequest&fetch | 覆写请求接口对象")])]),s("li",[s("a",{attrs:{href:"#日志上报方式"}},[t._v("日志上报方式")]),s("ul",[s("li",[s("a",{attrs:{href:"#注意跨源脚本异常"}},[t._v("注意跨源脚本异常")])])])]),s("li",[s("a",{attrs:{href:"#几个异常监控的问题"}},[t._v("几个异常监控的问题")])]),s("li",[s("a",{attrs:{href:"#参考文章"}},[t._v("参考文章")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"前端错误异常按照捕获方式分类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端错误异常按照捕获方式分类"}},[t._v("#")]),t._v(" 前端错误异常按照捕获方式分类")]),t._v(" "),s("ul",[s("li",[t._v("语法错误")]),t._v(" "),s("li",[t._v("运行时异常")]),t._v(" "),s("li",[t._v("资源加载异常\n"),s("ul",[s("li",[t._v("img")]),t._v(" "),s("li",[t._v("script")]),t._v(" "),s("li",[t._v("link")]),t._v(" "),s("li",[t._v("audio")]),t._v(" "),s("li",[t._v("video")]),t._v(" "),s("li",[t._v("iframe")]),t._v(" "),s("li",[t._v("外链资源的DOM元素")])])]),t._v(" "),s("li",[t._v("异步请求异常\n"),s("ul",[s("li",[t._v("XMLHttpRequest")]),t._v(" "),s("li",[t._v("fetch")])])]),t._v(" "),s("li",[t._v("Promise 异常")])]),t._v(" "),s("h2",{attrs:{id:"try-catch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#try-catch"}},[t._v("#")]),t._v(" try...catch")]),t._v(" "),s("blockquote",[s("p",[t._v("将能引发异常的代码块放到 "),s("code",[t._v("try")]),t._v(" 中，并对应一个响应，然后有异常会被捕获。")])]),t._v(" "),s("p",[s("strong",[t._v("只能捕获同步代码的异常。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模拟一段可能有错误的代码")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 捕获到try中代码块的错误得到一个错误对象e，进行处理分析")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("report")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h2",{attrs:{id:"window-onerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#window-onerror"}},[t._v("#")]),t._v(" window.onerror")]),t._v(" "),s("p",[t._v("当"),s("code",[t._v("JavaScript")]),t._v("运行时错误（包括语法错误）发生时，"),s("code",[t._v("window")]),t._v("会触发一个ErrorEvent接口的error事件，并执行"),s("code",[t._v("window.onerror()")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("语法错误会导致当前代码块运行终止，从而导致整个程序运行中断。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n * @description 运行时错误处理器\n * @param {string} message 错误信息\n * @param {string} source 发生错误的脚本URL\n * @param {number} lineno 发生错误的行号\n * @param {number} colno 发生错误的列号\n * @param {object} error Error对象\n */")]),t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lineNo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnNo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("h2",{attrs:{id:"window-addeventlistener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#window-addeventlistener"}},[t._v("#")]),t._v(" window.addEventListener")]),t._v(" "),s("h3",{attrs:{id:"error-事件捕获资源加载错误"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-事件捕获资源加载错误"}},[t._v("#")]),t._v(" error 事件捕获资源加载错误")]),t._v(" "),s("h3",{attrs:{id:"unhandledrejection事件捕获promise异常"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unhandledrejection事件捕获promise异常"}},[t._v("#")]),t._v(" unhandledrejection事件捕获Promise异常")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("unhandledrejection")]),t._v(" 事件用于全局捕获 "),s("code",[t._v("promise")]),t._v(" 对象没有 "),s("code",[t._v("rejection")]),t._v(" 处理器时异常情况。")])]),t._v(" "),s("h2",{attrs:{id:"promise-then-catch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promise-then-catch"}},[t._v("#")]),t._v(" Promise.then().catch")]),t._v(" "),s("h2",{attrs:{id:"封装xmlhttprequest-fetch-覆写请求接口对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#封装xmlhttprequest-fetch-覆写请求接口对象"}},[t._v("#")]),t._v(" 封装XMLHttpRequest&fetch | 覆写请求接口对象")]),t._v(" "),s("h2",{attrs:{id:"日志上报方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志上报方式"}},[t._v("#")]),t._v(" 日志上报方式")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("异步请求上报，后端提供接口，或者直接发到日志服务器")])]),t._v(" "),s("li",[t._v("img 请求上报，url 参数带上错误信息。\n"),s("ul",[s("li",[s("code",[t._v("(new Image()).src = 'http://baidu.com/tesjk?r=tksjk'")])])])])]),t._v(" "),s("h3",{attrs:{id:"注意跨源脚本异常"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意跨源脚本异常"}},[t._v("#")]),t._v(" 注意跨源脚本异常")]),t._v(" "),s("h2",{attrs:{id:"几个异常监控的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#几个异常监控的问题"}},[t._v("#")]),t._v(" 几个异常监控的问题")]),t._v(" "),s("ul",[s("li",[t._v("如何保证大家提交的代码是符合预期的？如何了解前端项目的运行是否正常，是否存在错误？代码质量体系控制和错误监控以及性能分析；")]),t._v(" "),s("li",[t._v("若使用了脚本代码压缩，又不想将sourcemap文件发布到线上，该如何捕获到错误的具体信息？")]),t._v(" "),s("li",[t._v("CSS文件中也存在引用资源，@font-face，background-image... 等这些请求错误该如何进行错误捕获？")]),t._v(" "),s("li",[t._v("如果用户使用网页、发现白屏，联系上我们，我们应该如何排查呢？（以用户访问页面的过程为顺序来排查：）\n"),s("ul",[s("li",[t._v("用户没打开网络")]),t._v(" "),s("li",[s("strong",[t._v("DNS域名劫持")])]),t._v(" "),s("li",[s("strong",[t._v("http劫持")])]),t._v(" "),s("li",[s("strong",[t._v("cdn或者其他资源文件访问出错")])]),t._v(" "),s("li",[s("strong",[t._v("服务器错误")])]),t._v(" "),s("li",[s("strong",[t._v("前端代码错误")])]),t._v(" "),s("li",[s("strong",[t._v("前端兼容性问题")])]),t._v(" "),s("li",[s("strong",[t._v("用户操作出错")])])])])]),t._v(" "),s("p",[s("strong",[t._v("需要向用户手机收集以下的用户信息：")])]),t._v(" "),s("ul",[s("li",[t._v("当前的网络状态")]),t._v(" "),s("li",[t._v("运营商")]),t._v(" "),s("li",[t._v("地理位置")]),t._v(" "),s("li",[t._v("访问时间")]),t._v(" "),s("li",[t._v("客户端的版本")]),t._v(" "),s("li",[t._v("系统版本")]),t._v(" "),s("li",[t._v("浏览器信息")]),t._v(" "),s("li",[t._v("设备分辨率")]),t._v(" "),s("li",[t._v("页面的来源")]),t._v(" "),s("li",[t._v("用户的账号信息")]),t._v(" "),s("li",[t._v("通过 "),s("code",[t._v("performance API")]),t._v(" 收集用户各个页面访问流程所消耗的时间")]),t._v(" "),s("li",[t._v("收集用户js代码报错的信息")])]),t._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000016959011",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端异常监控"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.fundebug.com/2019/07/06/how-to-monitor-javascript-error/",target:"_blank",rel:"noopener noreferrer"}},[t._v("一步一步搭建前端监控系统：JS错误监控篇"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);