<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Wing Blog</title>
    <meta name="description" content="Just record something">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/img/avatar.jpeg">
    
    <link rel="preload" href="/assets/css/0.styles.3f43dc52.css" as="style"><link rel="preload" href="/assets/js/app.c954533f.js" as="script"><link rel="preload" href="/assets/js/2.e9d48de4.js" as="script"><link rel="preload" href="/assets/js/99.9928bacb.js" as="script"><link rel="prefetch" href="/assets/js/10.447c507d.js"><link rel="prefetch" href="/assets/js/100.8c16df8a.js"><link rel="prefetch" href="/assets/js/101.e3fda152.js"><link rel="prefetch" href="/assets/js/102.6fb9e360.js"><link rel="prefetch" href="/assets/js/103.9f6e999f.js"><link rel="prefetch" href="/assets/js/104.f56439ee.js"><link rel="prefetch" href="/assets/js/105.0a32f3f9.js"><link rel="prefetch" href="/assets/js/106.f5aee7fc.js"><link rel="prefetch" href="/assets/js/107.929f6ebd.js"><link rel="prefetch" href="/assets/js/108.ac2f9270.js"><link rel="prefetch" href="/assets/js/109.50a23c74.js"><link rel="prefetch" href="/assets/js/11.991bcd5d.js"><link rel="prefetch" href="/assets/js/110.1c2fb050.js"><link rel="prefetch" href="/assets/js/111.feb72b61.js"><link rel="prefetch" href="/assets/js/112.7bc65938.js"><link rel="prefetch" href="/assets/js/113.5c018eb4.js"><link rel="prefetch" href="/assets/js/114.ae6bc6dd.js"><link rel="prefetch" href="/assets/js/115.a057b4c5.js"><link rel="prefetch" href="/assets/js/116.1ae73d5a.js"><link rel="prefetch" href="/assets/js/117.818ba8f7.js"><link rel="prefetch" href="/assets/js/118.8b69fcd8.js"><link rel="prefetch" href="/assets/js/119.50c08c51.js"><link rel="prefetch" href="/assets/js/12.d1780b21.js"><link rel="prefetch" href="/assets/js/120.da42f1d0.js"><link rel="prefetch" href="/assets/js/121.c792d179.js"><link rel="prefetch" href="/assets/js/122.ac156187.js"><link rel="prefetch" href="/assets/js/123.756b83ed.js"><link rel="prefetch" href="/assets/js/124.3537e35f.js"><link rel="prefetch" href="/assets/js/125.3ed080fb.js"><link rel="prefetch" href="/assets/js/126.58063c44.js"><link rel="prefetch" href="/assets/js/127.c48b43d2.js"><link rel="prefetch" href="/assets/js/128.9d1ce907.js"><link rel="prefetch" href="/assets/js/129.0eaf345b.js"><link rel="prefetch" href="/assets/js/13.73dfaff3.js"><link rel="prefetch" href="/assets/js/14.f816ab48.js"><link rel="prefetch" href="/assets/js/15.e8405f02.js"><link rel="prefetch" href="/assets/js/16.3b321d62.js"><link rel="prefetch" href="/assets/js/17.f6f9bef4.js"><link rel="prefetch" href="/assets/js/18.6e369942.js"><link rel="prefetch" href="/assets/js/19.f313a8ea.js"><link rel="prefetch" href="/assets/js/20.67543922.js"><link rel="prefetch" href="/assets/js/21.10add373.js"><link rel="prefetch" href="/assets/js/22.12aba6da.js"><link rel="prefetch" href="/assets/js/23.7e7ec4be.js"><link rel="prefetch" href="/assets/js/24.281d4ce5.js"><link rel="prefetch" href="/assets/js/25.e09dd31a.js"><link rel="prefetch" href="/assets/js/26.aa608eac.js"><link rel="prefetch" href="/assets/js/27.62b8ab58.js"><link rel="prefetch" href="/assets/js/28.f02a32c7.js"><link rel="prefetch" href="/assets/js/29.ffc7d06f.js"><link rel="prefetch" href="/assets/js/3.3294bca2.js"><link rel="prefetch" href="/assets/js/30.e78d3d4b.js"><link rel="prefetch" href="/assets/js/31.d80615a0.js"><link rel="prefetch" href="/assets/js/32.56bc2415.js"><link rel="prefetch" href="/assets/js/33.25d97a71.js"><link rel="prefetch" href="/assets/js/34.4976cfa0.js"><link rel="prefetch" href="/assets/js/35.0ea17df0.js"><link rel="prefetch" href="/assets/js/36.5a1fb531.js"><link rel="prefetch" href="/assets/js/37.2c6ed432.js"><link rel="prefetch" href="/assets/js/38.f56c5825.js"><link rel="prefetch" href="/assets/js/39.9dd38f14.js"><link rel="prefetch" href="/assets/js/4.225f6688.js"><link rel="prefetch" href="/assets/js/40.33bf0c3b.js"><link rel="prefetch" href="/assets/js/41.bdd1be1a.js"><link rel="prefetch" href="/assets/js/42.d6ebdb91.js"><link rel="prefetch" href="/assets/js/43.265719cb.js"><link rel="prefetch" href="/assets/js/44.b6718f89.js"><link rel="prefetch" href="/assets/js/45.b006c5c0.js"><link rel="prefetch" href="/assets/js/46.c3c547c7.js"><link rel="prefetch" href="/assets/js/47.118f99fc.js"><link rel="prefetch" href="/assets/js/48.4b670bfd.js"><link rel="prefetch" href="/assets/js/49.d70a0beb.js"><link rel="prefetch" href="/assets/js/5.bc6759dd.js"><link rel="prefetch" href="/assets/js/50.e0bbb626.js"><link rel="prefetch" href="/assets/js/51.1c2f8438.js"><link rel="prefetch" href="/assets/js/52.1c3919be.js"><link rel="prefetch" href="/assets/js/53.5f0efeaf.js"><link rel="prefetch" href="/assets/js/54.0bed3f43.js"><link rel="prefetch" href="/assets/js/55.14cbce1a.js"><link rel="prefetch" href="/assets/js/56.0ddebe67.js"><link rel="prefetch" href="/assets/js/57.5906c5f0.js"><link rel="prefetch" href="/assets/js/58.fedf1aef.js"><link rel="prefetch" href="/assets/js/59.336a4001.js"><link rel="prefetch" href="/assets/js/6.66d46959.js"><link rel="prefetch" href="/assets/js/60.c510567f.js"><link rel="prefetch" href="/assets/js/61.c0308e61.js"><link rel="prefetch" href="/assets/js/62.eea74626.js"><link rel="prefetch" href="/assets/js/63.427a11c7.js"><link rel="prefetch" href="/assets/js/64.345ff07a.js"><link rel="prefetch" href="/assets/js/65.03ce68f5.js"><link rel="prefetch" href="/assets/js/66.40db4f87.js"><link rel="prefetch" href="/assets/js/67.d088d584.js"><link rel="prefetch" href="/assets/js/68.82b07c60.js"><link rel="prefetch" href="/assets/js/69.1de4869f.js"><link rel="prefetch" href="/assets/js/7.a4f9bbf3.js"><link rel="prefetch" href="/assets/js/70.345c7558.js"><link rel="prefetch" href="/assets/js/71.54bc0729.js"><link rel="prefetch" href="/assets/js/72.73f4e07b.js"><link rel="prefetch" href="/assets/js/73.7b4b86d2.js"><link rel="prefetch" href="/assets/js/74.de6fb6f5.js"><link rel="prefetch" href="/assets/js/75.69ad8abb.js"><link rel="prefetch" href="/assets/js/76.af4b632a.js"><link rel="prefetch" href="/assets/js/77.69e9341d.js"><link rel="prefetch" href="/assets/js/78.9c3062c9.js"><link rel="prefetch" href="/assets/js/79.ef42e0e0.js"><link rel="prefetch" href="/assets/js/8.8293228a.js"><link rel="prefetch" href="/assets/js/80.062e3510.js"><link rel="prefetch" href="/assets/js/81.85c49cd4.js"><link rel="prefetch" href="/assets/js/82.5fc0c68a.js"><link rel="prefetch" href="/assets/js/83.cc3f32c4.js"><link rel="prefetch" href="/assets/js/84.229d3554.js"><link rel="prefetch" href="/assets/js/85.63a643ba.js"><link rel="prefetch" href="/assets/js/86.ada6fa00.js"><link rel="prefetch" href="/assets/js/87.70cc7f07.js"><link rel="prefetch" href="/assets/js/88.0cdd3478.js"><link rel="prefetch" href="/assets/js/89.6f39bf76.js"><link rel="prefetch" href="/assets/js/9.53eb360a.js"><link rel="prefetch" href="/assets/js/90.a72da4be.js"><link rel="prefetch" href="/assets/js/91.5be3d9e1.js"><link rel="prefetch" href="/assets/js/92.6b8333f8.js"><link rel="prefetch" href="/assets/js/93.83bef40c.js"><link rel="prefetch" href="/assets/js/94.e16639c1.js"><link rel="prefetch" href="/assets/js/95.511806d6.js"><link rel="prefetch" href="/assets/js/96.83656f59.js"><link rel="prefetch" href="/assets/js/97.54f03ce3.js"><link rel="prefetch" href="/assets/js/98.d98e2ddb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3f43dc52.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpeg" alt="Wing Blog" class="logo"> <span class="site-name can-hide">Wing Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front Menu" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Front-end/MemorySpace.html" class="nav-link">
  JS基础进阶
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/reduce.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/ES6/let和const.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/CSS/Flex/Flex布局.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Vue/Vue日常开发/总结.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Node/nodejs中的异常错误处理.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Webpack/Webpack优化.html" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataStructure-Algorithm Menu" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/DataStructure-Algorithm/DataStructure/Stack.html" class="nav-link">
  DataStructure
</a></li><li class="dropdown-item"><!----> <a href="/pages/DataStructure-Algorithm/Algorithm/贪心算法.html" class="nav-link">
  Algorithm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="BackEnd Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Back-end/Database.html" class="nav-link">
  Database
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet Menu" class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Internet/网络知识体系.html" class="nav-link">
  网络知识体系
</a></li><li class="dropdown-item"><!----> <a href="/pages/Internet/Web安全.html" class="nav-link">
  Web安全
</a></li><li class="dropdown-item"><!----> <a href="/pages/Internet/Cookie.html" class="nav-link">
  Cookie
</a></li></ul></div></div><div class="nav-item"><a href="/pages/Think/在浏览器中输入了URL发生了什么.html" class="nav-link">
  思考
</a></div><div class="nav-item"><a href="/pages/MAC/如何在终端里面用其他程序打开文件.html" class="nav-link">
  MAC
</a></div><div class="nav-item"><a href="/pages/Fun/form-render.html" class="nav-link">
  Fun
</a></div> <a href="https://github.com/sfsoul/sfsoul.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front Menu" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Front-end/MemorySpace.html" class="nav-link">
  JS基础进阶
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/reduce.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/ES6/let和const.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/CSS/Flex/Flex布局.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Vue/Vue日常开发/总结.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Node/nodejs中的异常错误处理.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/pages/Front-end/Webpack/Webpack优化.html" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataStructure-Algorithm Menu" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/DataStructure-Algorithm/DataStructure/Stack.html" class="nav-link">
  DataStructure
</a></li><li class="dropdown-item"><!----> <a href="/pages/DataStructure-Algorithm/Algorithm/贪心算法.html" class="nav-link">
  Algorithm
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="BackEnd Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Back-end/Database.html" class="nav-link">
  Database
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet Menu" class="dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Internet/网络知识体系.html" class="nav-link">
  网络知识体系
</a></li><li class="dropdown-item"><!----> <a href="/pages/Internet/Web安全.html" class="nav-link">
  Web安全
</a></li><li class="dropdown-item"><!----> <a href="/pages/Internet/Cookie.html" class="nav-link">
  Cookie
</a></li></ul></div></div><div class="nav-item"><a href="/pages/Think/在浏览器中输入了URL发生了什么.html" class="nav-link">
  思考
</a></div><div class="nav-item"><a href="/pages/MAC/如何在终端里面用其他程序打开文件.html" class="nav-link">
  MAC
</a></div><div class="nav-item"><a href="/pages/Fun/form-render.html" class="nav-link">
  Fun
</a></div> <a href="https://github.com/sfsoul/sfsoul.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/pages/Internet/网络知识体系.html" class="active sidebar-link">网络知识体系</a></li><li><a href="/pages/Internet/Web安全.html" class="sidebar-link">Web安全</a></li><li><a href="/pages/Internet/Cookie.html" class="sidebar-link">Cookie</a></li><li><a href="/pages/Internet/跨域.html" class="sidebar-link">跨域</a></li><li><a href="/pages/Internet/为什么HTTP1.1不能实现多路复用.html" class="sidebar-link">为什么HTTP1.1不能实现多路复用</a></li><li><a href="/pages/Internet/谈谈对TCP三次握手和四次挥手的理解.html" class="sidebar-link">谈谈对TCP三次握手和四次挥手的理解</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#http-缓存">HTTP 缓存</a><ul><li><a href="#缓存的资源去哪里了？">缓存的资源去哪里了？</a></li><li><a href="#强缓存（cache-control、expires、pragma）">强缓存（Cache-control、Expires、Pragma）</a></li><li><a href="#协商缓存">协商缓存</a></li><li><a href="#浏览器缓存过程">浏览器缓存过程</a></li><li><a href="#no-cache-与-no-store-的区别？">no-cache 与 no-store 的区别？</a></li></ul></li><li><a href="#dns-寻址过程">DNS 寻址过程</a><ul><li><a href="#客户端-浏览器查找">客户端/浏览器查找</a></li><li><a href="#迭代查找过程">迭代查找过程</a></li></ul></li><li><a href="#http1-和-http2-有什么区别？http2-的优势">HTTP1 和 HTTP2 有什么区别？HTTP2 的优势</a><ul><li><a href="#http-1-存在的问题">HTTP/1 存在的问题</a></li><li><a href="#http2-的新特性">HTTP2 的新特性</a></li><li><a href="#http2-0-的缺点">HTTP2.0 的缺点</a></li><li><a href="#http2-0的多路复用和http1-x中的长连接复用有什么区别？">HTTP2.0的多路复用和HTTP1.X中的长连接复用有什么区别？</a></li><li><a href="#http3">HTTP3</a></li></ul></li><li><a href="#get-post-请求传参长度有什么特点？">get/post 请求传参长度有什么特点？</a></li><li><a href="#谈谈对-dns-prefetch-的理解">谈谈对 dns-prefetch 的理解</a><ul><li><a href="#使用方式">使用方式</a></li></ul></li><li><a href="#web-性能优化">web 性能优化</a></li><li><a href="#cdn-原理">CDN 原理</a><ul><li><a href="#dns-的记录类型">DNS 的记录类型</a></li><li><a href="#通过-cdn-获取缓存内容的过程">通过 CDN 获取缓存内容的过程</a></li><li><a href="#cdn-优势">CDN 优势</a></li><li><a href="#简要概况">简要概况</a></li></ul></li><li><a href="#跨域">跨域</a><ul><li><a href="#什么是同源策略">什么是同源策略</a></li><li><a href="#cors">CORS</a></li><li><a href="#node-正向代理">Node 正向代理</a></li><li><a href="#nginx-反向代理">Nginx 反向代理</a></li><li><a href="#jsonp">JSONP</a></li><li><a href="#websocket">Websocket</a></li></ul></li><li><a href="#正向代理与反向代理">正向代理与反向代理</a><ul><li><a href="#了解代理">了解代理</a></li><li><a href="#正向代理（多指-vpn）">正向代理（多指 VPN）</a></li><li><a href="#正向代理用途">正向代理用途</a></li><li><a href="#反向代理（nginx）">反向代理（Nginx）</a></li></ul></li><li><a href="#https-原理">HTTPS 原理</a></li><li><a href="#options-请求的理解">options 请求的理解</a><ul><li><a href="#什么是-options-请求">什么是 options 请求</a></li><li><a href="#options-关键的请求头字段">options 关键的请求头字段</a></li><li><a href="#options-请求优化">Options 请求优化</a></li><li><a href="#总结">总结</a></li></ul></li><li><a href="#http状态码301与302的区别">Http状态码301与302的区别</a><ul><li><a href="#什么是301重定向？">什么是301重定向？</a></li><li><a href="#什么是302重定向？">什么是302重定向？</a></li><li><a href="#区别">区别</a></li></ul></li><li><a href="#为什么-http1-1-不能实现多路复用">为什么 HTTP1.1 不能实现多路复用</a></li><li><a href="#参考">参考</a></li></ul></div><p></p> <h2 id="http-缓存"><a href="#http-缓存" class="header-anchor">#</a> HTTP 缓存</h2> <blockquote><p>缓存的主要作用：<strong>可以加快资源获取速度，提升用户体验，减少网络传输，缓解服务端的压力。</strong> 分为强缓存与协商缓存两种。<strong>强缓存不会向服务器发起请求，直接读取浏览器本地的缓存；协商缓存会向服务器发起请求。</strong></p></blockquote> <p><img src="https://i.loli.net/2020/05/31/5RIbtYmO1ZWhB9C.png" alt=""></p> <h3 id="缓存的资源去哪里了？"><a href="#缓存的资源去哪里了？" class="header-anchor">#</a> 缓存的资源去哪里了？</h3> <blockquote><p><strong>浏览器存储了资源，它将资源存储在 memory cache 或者 disk cache 中。</strong></p></blockquote> <p><strong>memory cache</strong>：将资源缓存到内存中，等待下次访问时不需要重新下载资源，而是直接从内存中获取。</p> <p><strong>disk cache</strong>：将资源缓存到磁盘中，等待下次访问时不需要重新下载资源，而直接从磁盘中读取。</p> <table><thead><tr><th></th> <th>Memory cache</th> <th>disk cache</th></tr></thead> <tbody><tr><td>相同点</td> <td>只能存储一些派生类资源文件</td> <td>只能存储一些派生类资源文件</td></tr> <tr><td>不同点</td> <td>退出进程时数据会被清除</td> <td>退出进程时数据不会被清除</td></tr> <tr><td>存储资源</td> <td>一般脚本、字体、图片会存在内存中</td> <td>一般非脚本会存在内存当中，如css等</td></tr></tbody></table> <ul><li>先在内存中查找，若有直接加载</li> <li>若内存中不存在，则在硬盘中查找，若有直接加载</li> <li>若硬盘中也没有，进行网络请求</li> <li>请求获取的资源缓存到硬盘和内存</li></ul> <h3 id="强缓存（cache-control、expires、pragma）"><a href="#强缓存（cache-control、expires、pragma）" class="header-anchor">#</a> 强缓存（Cache-control、Expires、Pragma）</h3> <p><strong>优先级：<code>pragma</code> &gt; <code>cache-control</code> &gt; <code>expires</code></strong>。</p> <h4 id="expires"><a href="#expires" class="header-anchor">#</a> Expires</h4> <p>Expires 的值是一个绝对时间，在浏览器发起请求时，会根据系统时间和 Expires 的值进行比较，若系统时间超过了 Expires 的值，缓存失效。<strong>当用户主动修改客户端时间时，会导致缓存有效期不准的问题。</strong></p> <h4 id="cache-control"><a href="#cache-control" class="header-anchor">#</a> Cache-Control</h4> <p>Cache-Control 是 HTTP/1.1 中新增的属性，在请求头和响应头中都可以使用，常见的属性值有：</p> <ul><li>Max-age：单位为秒，<strong>缓存时间计算的方式是距离发起的时间的秒数，超过间隔的秒数缓存失效</strong></li> <li>no-cache：<strong>不使用强缓存，需要与服务器验证缓存是否新鲜。若文件没变化，服务器只告诉浏览器继续使用缓存（304）。</strong></li> <li>no-store：<strong>禁止使用缓存（包括协商缓存），每次都向服务器请求最新的资源</strong></li> <li>private：<strong>专用于个人的缓存，中间代理、CDN 等不能缓存此响应</strong></li> <li>public：<strong>响应可以被中间代理、CDN 等缓存</strong></li> <li>must-revalidate：<strong>在缓存过期前可以使用，过期后必须向服务器验证</strong></li></ul> <h4 id="pragma"><a href="#pragma" class="header-anchor">#</a> Pragma</h4> <p><strong>Pragma 只有一个属性值，就是 <code>no-cache</code>，效果和 Cache-Control 中的 <code>no-cache</code> 一致，不使用强缓存，需要与服务器验证缓存是否新鲜，在3个头部属性中的优先级最高。</strong></p> <h3 id="协商缓存"><a href="#协商缓存" class="header-anchor">#</a> 协商缓存</h3> <blockquote><p>当浏览器的强缓存失效时或者请求头中设置了不走强缓存，并且在请求头中设置了 <code>If-Modified-Since</code> 或者 <code>If-None-Match</code> 时，会将这两个属性值发送到服务端去验证是否命中协商缓存。<strong>若命中协商缓存，服务器直接返回  304 状态码，不会返回新资源。若未命中协商缓存，服务器返回 200 状态码，且返回新资源，同时更新 <code>If-Modified</code> 和 <code>Etag</code> 的值。</strong></p></blockquote> <h4 id="etag-if-none-match"><a href="#etag-if-none-match" class="header-anchor">#</a> ETag/If-None-Match</h4> <p><strong>ETag/If-None-Match 的值是一串 hash 码，代表的是一个资源的标识符，当服务端的文件变化的时候，它的 hash 码会随之变化。通过请求头中的 <code>If-None-Match</code> 和当前文件的 hash 值进行比较，若相等则表示命中协商缓存。</strong></p> <h4 id="last-modified-if-modified-since"><a href="#last-modified-if-modified-since" class="header-anchor">#</a> Last-Modified/If-Modified-Since</h4> <p><strong>Last-Modified/If-Modified-Since 的值代表的是文件的最后修改时间。</strong></p> <h4 id="last-modified-存在的问题"><a href="#last-modified-存在的问题" class="header-anchor">#</a> Last-Modified 存在的问题</h4> <blockquote><p><strong>Last-Modified 过期时间只能精确到秒。</strong></p></blockquote> <p>精确到秒会存在两个问题（以静态资源 a.js 为例）：</p> <ul><li><strong>若 a.js 在一秒时间内经常变动，同时服务器给 a.js 设置无强缓存，那浏览器每次访问 a.js 都会去请求服务器，此时服务器比较发给浏览器的上次修改时间和 a.js 的最近修改时间，发现都是在同一个时间（因为精确到秒），因此返回给浏览器继续使用本地缓存的资源（304），但事实上服务器上的 a.js 已经改动了很多次。这种情况下，浏览器拿不到最新的 a.js 文件。</strong></li> <li><strong>如果在服务器上 a.js 被修改了，但其实际内容根本没发生改变，会因为 Last-Modified 时间匹配不上而重新返回 a.js 给浏览器。</strong></li></ul> <h3 id="浏览器缓存过程"><a href="#浏览器缓存过程" class="header-anchor">#</a> 浏览器缓存过程</h3> <ul><li>浏览器第一次加载资源，服务器返回200，浏览器将资源文件从服务器上请求下载下来，并把响应头中的 Cache-Control、Expires、Last-Modified、Etag 一并缓存。</li> <li>下一次加载资源时，先比较当前时间和上一次请求返回200的时间差。如果没超过 Cache-Control 设置的 max-age，则没有过期，命中强缓存，不发请求直接从本地缓存读取该文件（如果浏览器不支持HTTP1.1，则用 Expires 判断是否过期）。</li> <li>若时间过期，则向服务器发送请求，同时请求头中带有 If-Modified-Since 和 If-None-Match。</li> <li>服务器收到请求后，优先根据 Etag 的值判断被请求的文件是否有被修改，Etag 值一致则没有修改，命中协商缓存，返回304；如果不一致则有改动，直接返回新的资源文件带上新的 Etag 值并返回200.</li> <li>如果服务器收到的请求没有 Etag 值，则将 If-Modified-Since 和被请求文件的最后修改时间做比对，一致则命中协商缓存，返回304；不一致则返回新的 Last-Modified 和文件并返回200。</li></ul> <h3 id="no-cache-与-no-store-的区别？"><a href="#no-cache-与-no-store-的区别？" class="header-anchor">#</a> no-cache 与 no-store 的区别？</h3> <blockquote><p><code>no-cache</code> 和 <code>no-store</code> 都是 HTTP 协议头 <code>Cache-Control</code> 的值。</p></blockquote> <ul><li><code>no-cache</code>：<strong>在浏览器使用缓存前，会往返对比 ETag。若 ETag 没变，返回304使用缓存。</strong></li> <li><code>no-store</code>：<strong>彻底禁用缓存（浏览器不缓存内容），所有内容都不会被缓存到缓存或临时文件中。</strong></li> <li><code>public</code>：<strong>所有内容都将被缓存（客户端和代理服务器都可缓存）</strong></li> <li><code>private</code>：<strong>内容只缓存到私有缓存中（仅客户端可缓存，代理服务器不可缓存）</strong></li> <li><code>max-age=xxx</code>：<strong>缓存的内容将在 xxx 秒后失败，此选项只在 HTTP1.1 可用。如果和 <code>Last-Modified</code> 一起使用，优先级较高。</strong></li></ul> <h2 id="dns-寻址过程"><a href="#dns-寻址过程" class="header-anchor">#</a> DNS 寻址过程</h2> <blockquote><p><strong>DNS 的域名查找：在客户端和浏览器，本地 DNS 之间的查询方式是递归查询；在本地DNS服务器与根域及其子域之间的查询方式是迭代查询。</strong></p></blockquote> <h3 id="客户端-浏览器查找"><a href="#客户端-浏览器查找" class="header-anchor">#</a> 客户端/浏览器查找</h3> <p><img src="https://i.loli.net/2020/05/31/LoAkFcIZynU3GE9.png" alt="递归过程"></p> <p><strong>在客户端输入 URL 后，会有一个递归查询的过程：从浏览器缓存中查找 --&gt; 本地的hosts文件查找 --&gt; 找本地DNS解析器缓存查找 --&gt; 本地DNS服务器查找。</strong></p> <h3 id="迭代查找过程"><a href="#迭代查找过程" class="header-anchor">#</a> 迭代查找过程</h3> <p><img src="https://i.loli.net/2020/05/31/6OfAtlVwyrCvczH.png" alt="迭代查找过程"></p> <ul><li>本地 DNS 服务器向 根域名 DNS 服务器发起查询，根域名 DNS 服务器返回顶级域 DNS 服务器的 IP 地址</li> <li>本地 DNS 服务器向 顶级域 DNS 服务器发起查询，顶级域 DNS 服务器返回权威 DNS 服务器的 IP 地址</li> <li>本地 DNS 服务器向 权威 DNS 服务器发起查询，权威 DNS 服务器返回相应主机的 IP 地址。</li></ul> <h2 id="http1-和-http2-有什么区别？http2-的优势"><a href="#http1-和-http2-有什么区别？http2-的优势" class="header-anchor">#</a> HTTP1 和 HTTP2 有什么区别？HTTP2 的优势</h2> <h3 id="http-1-存在的问题"><a href="#http-1-存在的问题" class="header-anchor">#</a> HTTP/1 存在的问题</h3> <p><strong>HTTP1.x 存在最大的问题就是：线头阻塞（Head of line blocking）。</strong></p> <h3 id="http2-的新特性"><a href="#http2-的新特性" class="header-anchor">#</a> HTTP2 的新特性</h3> <ul><li><strong>首部压缩（Header Compression）</strong>：HTTP1.x 的 header 带有大量信息，而且每次都要重复发送，<strong>HTTP2.0 使用 encoder 来减少需要传输的 header 大小，通讯双方各自 cache 一份 header fields 表，既避免了重复 header 的传输，又减小了需要传输的大小。</strong></li> <li><strong>服务端推送（server push）</strong>：<strong>服务端推送是一种在客户端请求之前发送数据的机制。在 HTTP/2 中，服务器可以对客户端的一个请求发送多个响应。若一个请求是由你的主页发起的，服务器很可能会响应主页内容、logo以及样式表，因为它知道客户端会用到这些东西。这相当于在一个 HTML 文档内集合了所有的资源。服务器推送还有一个很大的优势：可以缓存！也让在遵循同源的情况下，不同页面之间可以共享缓存资源成为可能。</strong></li> <li><strong>多路复用（MultiPlexing）</strong>：即连接共享，每一个 request 都是用作连接共享机制的。一个 request 对应一个 id，这样一个连接上可以有多个 request，每个连接的 request 可以随机的混杂在一起，接收方可以根据 request 的 id 将 request 再归属到各自不同的服务端请求里面。<strong>HTTP/2 可以实现多流并行而不用依赖建立多个 TCP 连接，HTTP/2 把 HTTP 协议通信的基本单位缩小为一个一个的帧，这些帧对应着逻辑流中的消息。并行地在同一个 TCP 连接上双向交换消息。</strong></li> <li><strong>新的二进制格式（Binary Format）</strong>：<strong>HTTP1.x 的解析是基于文本，基于文本协议的格式解析存在天然缺陷，文本的表现形式有多样性，要做到健壮性考虑的场景必然很多；二进制不同，只认0和1的组合。基于这种考虑HTTP2.0的协议解析决定采用二进制格式，实现方便且健壮。</strong></li></ul> <p><img src="https://i.loli.net/2020/05/24/JVfExGo8Z3Pb9va.png" alt="HTTP/2.0 多路复用"></p> <h3 id="http2-0-的缺点"><a href="#http2-0-的缺点" class="header-anchor">#</a> HTTP2.0 的缺点</h3> <ul><li><strong>TCP 以及 TCP+TLS 建立连接的延时。</strong> HTTP/2 使用 TCP 协议来传输的，如果使用 HTTPS 的话，还需要使用 TLS      协议进行安全传输，而使用 TLS 也需要一个握手过程，在传输数据之前，导致需要花费 3~4 个RTT。</li> <li><strong>TCP 的队头阻塞并没有彻底解决。 在 HTTP/2 中，多个请求是跑在一个 TCP 管道中的。但当 HTTP/2 出现丢包时，整个 TCP 都要开始等待重传，此时就会阻塞该 TCP 连接中的所有请求。</strong></li></ul> <h3 id="http2-0的多路复用和http1-x中的长连接复用有什么区别？"><a href="#http2-0的多路复用和http1-x中的长连接复用有什么区别？" class="header-anchor">#</a> HTTP2.0的多路复用和HTTP1.X中的长连接复用有什么区别？</h3> <ul><li><em><em>HTTP/1.</em> 一次请求-响应，建立一个连接，用完关闭；每一个请求都要建立一个 TCP 连接</em>*</li> <li><strong>HTTP/1.1 <code>Pipeling</code> 解决方式为：若干个请求排队串行化单线程处理，后面的请求等待前面请求的返回才能获取执行机会，一旦有某个请求超时，后续请求只能被阻塞，这就是常说的线头阻塞。</strong></li> <li><strong>HTTP/2.0 多个请求可同时在一个连接上并行执行。某个请求任务耗时严重，不会影响到其它连接的正常执行。</strong></li></ul> <h3 id="http3"><a href="#http3" class="header-anchor">#</a> HTTP3</h3> <blockquote><p>一个基于 UDP 协议的 QUIC 协议，让 HTTP 跑在QUIC上而不是TCP上。</p></blockquote> <ul><li>实现了类似TCP的流量控制、传输可靠性的功能。虽然UDP不提供可靠性的传输，但QUIC在UDP的基础之上增加了一层来保证数据可靠性传输。它提供了数据包重传、拥塞控制以及其他一些TCP中存在的特性。</li> <li>实现了快速握手功能。由于QUIC是基于UDP的，所以QUIC可以实现使用 0-RTT 或者 1-RTT 来建立连接，这意味着QUIC可以用最快的速度来发送和接收数据。</li> <li>集成了TLS加密功能。QUIC使用的是TLS1.3，相较于早期版本TLS1.3有更多的优点，其中最重要的一点是减少了握手所花费的RTT个数。</li> <li>多路复用，彻底解决了TCP中队头阻塞的问题。</li></ul> <h2 id="get-post-请求传参长度有什么特点？"><a href="#get-post-请求传参长度有什么特点？" class="header-anchor">#</a> get/post 请求传参长度有什么特点？</h2> <blockquote><p><strong>经常说get请求参数的大小存在限制，而post请求的参数大小是无限制的。这是一个错误的说法，实际上HTTP协议从未规定 GET/POST 的请求长度限制是多少。对get请求参数的限制是来源于浏览器或web服务器，浏览器或web服务器限制了url长度。</strong></p></blockquote> <ul><li><strong>HTTP 协议未规定 GET 和 POST 的长度限制</strong></li> <li><strong>GET 的最大长度显示是因为浏览器和web服务器限制了URI的长度</strong></li> <li><strong>不同的浏览器和WEB服务器，限制的最大长度不一样</strong></li> <li>要支持IE，则最大长度为2083byte，若只支持Chrome，则最大长度8182byte</li></ul> <h2 id="谈谈对-dns-prefetch-的理解"><a href="#谈谈对-dns-prefetch-的理解" class="header-anchor">#</a> 谈谈对 dns-prefetch 的理解</h2> <blockquote><p>DNS Prefetching：<strong>浏览器根据自定义的规则，提前去解析后面可能用到的域名，来加速网站的访问速度。简单讲即提前解析域名，以免延迟。</strong></p></blockquote> <h3 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//wq.test.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>此功能有个默认加载条件，所有的 <code>a</code> 标签的 <code>href</code> 都会自动去启用 DNS Prefetching。即网页中的 <code>a</code> 标签 <code>href</code> 带的域名是不需要在 <code>head</code> 里面加上 <code>link</code> 手动设置的。但 <code>a</code> 标签的默认启动在 HTTPS 中不起作用。</strong></p> <p><strong>要使用 <code>meta</code> 中的 <code>http-equiv</code> 来强制启动功能。</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>x-dns-prefetch-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>总结：</strong></p> <ul><li>DNS Prefetching 是提前加载域名解析的，省去了解析时间。<code>a</code> 标签的 <code>href</code> 可以在 chrome、firefox 包括高版本的IE浏览器中默认开启，但是在 HTTPS 下不起作用，需要通过 <code>meta</code> 来强制开启功能。</li> <li><strong>这是 DNS 的提前解析，并不是 css，js 之类的文件缓存，不要混淆了两个不同的概念。</strong></li> <li>若直接做了 <code>js</code> 的重定向，或者在服务端做了重定向，没有在 <code>link</code> 里面手动设置，是不起作用的。</li> <li><strong>有利于什么样的网站呢？类似于 taobao 这种网站，网页中引用了大量其他域名的资源。若网站中的所有资源都在网站本域名下，那么这个基本没什么用。因为在进行 DNS 解析的时候，浏览器就帮忙缓存了域名所对应的 IP 信息了。</strong></li></ul> <h2 id="web-性能优化"><a href="#web-性能优化" class="header-anchor">#</a> web 性能优化</h2> <h2 id="cdn-原理"><a href="#cdn-原理" class="header-anchor">#</a> CDN 原理</h2> <blockquote><p>CDN（Content Delivery Network 内容分发网络）：<strong>将源站的内容发布到接近用户的网络&quot;边缘&quot;，用户可以就近获取所需数据，不仅降低了网络的拥塞状况、提高请求的响应速度，也能够减少源站的负载压力。</strong></p></blockquote> <h3 id="dns-的记录类型"><a href="#dns-的记录类型" class="header-anchor">#</a> DNS 的记录类型</h3> <blockquote><p>在 DNS 系统中，最常见的资源记录方式是 Internet 类记录，该记录由包含4个字段的数据构成：Name，Value，Type，TTL。其中 Name 和 Value 可以理解为一对键值对，但其具体含义取决于 Type 的类型。TTL 记录了该条记录应当从缓存中删除的时间。</p></blockquote> <p>在资源记录的类型中，最为常见且重要的类型 Type 主要有：</p> <ul><li>A记录（Address）：<strong>A记录用于描述目标域名到IP地址的映射关系，将目标域名与A记录的Name字段进行匹配，将成功匹配的记录的Value字段的内容（IP地址）输出到DNS回应报文中。</strong></li> <li>NS记录（Name Server）：<strong>NS记录用于描述目标域名到负责解析该域名的DNS的映射关系。根据目标域名对NS记录的Name字段进行匹配，将成功匹配的记录的Value字段（负责解析目标域名的DNS的IP地址）输出到DNS回应报文中。</strong></li> <li>CNAME记录：<strong>CNAME记录用于描述目的域名和别名的对应关系，如果说A记录可以将目标域名转换为对应主机的IP地址，那么CNAME记录则可以将一个域名（别名）转换为另一个域名。若多条CNAME记录指向同一个域名，则可以将多个不同的域名的请求指向同一台服务器主机。并且，CNAME记录通常还对应了一条A记录，用于提供被转换的域名的IP地址。</strong></li></ul> <h3 id="通过-cdn-获取缓存内容的过程"><a href="#通过-cdn-获取缓存内容的过程" class="header-anchor">#</a> 通过 CDN 获取缓存内容的过程</h3> <blockquote><p>CDN 将用户对源站的请求导向了距离用户较近的缓存节点，而非源站。</p></blockquote> <p><strong>在 DNS 解析域名时新增了一个 <code>全局负载均衡系统（GSLB）</code>，GSLB 的主要功能是根据用户的本地 DNS 的 IP 地址判断用户的位置，筛选出距离用户较近的 <code>本地负载均衡系统(SLB)</code>，并将该 SLB 的 IP 地址作为结果返回给本地 DNS。SLB 主要负责判断 <code>缓存服务器集群</code> 中是否包含用户请求的资源数据。若缓存服务器中存在请求的资源，则根据缓存服务器集群中节点的健康程度、负载量、连接数等因素筛选出最优的缓存节点，并将 HTTP 请求重定向到最优的缓存节点上。</strong></p> <p><img src="https://i.loli.net/2020/06/01/Fnh9HNXKCIwTZ82.png" alt="CDN 获取缓存内容过程"></p> <p>以客户端发起对 <code>&quot;join.qq.com/video.php&quot;</code> 的HTTP请求为例：</p> <ul><li>用户发起对 <code>&quot;join.qq.com/video.php&quot;</code> 的 HTTP 请求，首先需要本地 DNS 通过递归查询的方式获取域名 <code>&quot;join.qq.com&quot;</code> 的 IP 地址；</li> <li>若本地 DNS 的缓存中没有该域名的记录，则向 <code>根 DNS</code> 发起 DNS 查询报文；</li> <li><code>根 DNS</code> 发现域名的前缀为 <code>com</code>，则给出负责解析 <code>com</code> 的 <code>顶级 DNS</code> 的 IP 地址；</li> <li>本地 DNS 向 <code>顶级 DNS</code> 发送  DNS 查询报文；</li> <li><code>顶级 DNS</code> 发现域名的前缀为 <code>qq.com</code>，在本地记录中查找负责该前缀的 <code>权威 DNS</code> 的 IP 地址并进行回复；</li> <li>本地 DNS 向 <code>权威 DNS</code> 发送 DNS 查询报文；</li> <li><code>权威 DNS</code> 查找到一条 NAME 字段为 <code>&quot;join.qq.com&quot;</code> 的 <code>CNAME 记录（由服务提供者配置）</code>，该记录的 Value  字段为 <code>&quot;join.qq.cdn.com&quot;</code>；并且还找到另一条 NAME 字段为 <code>&quot;join.qq.cdn.com&quot;</code>的 A 记录，该记录的Value字段为 GSLB 的 IP 地址；</li> <li>本地 DNS 向 GSLB 发送 DNS 查询报文；</li> <li><strong>GSLB 根据 <code>本地 DNS</code> 的 IP 地址判断用户的大致位置为深圳，筛选出位于华南地区且综合考量最优的 SLB 的 IP 地址填入 DNS 回应报文，作为 DNS 查询的最终结果；</strong></li> <li>本地 DNS 回复客户端的 DNS 请求，将上一步的 IP 地址作为最终结果回复给客户端；</li> <li><strong>客户端根据 IP 地址向 SLB 发起 HTTP 请求：<code>&quot;join.qq.com/video.php&quot;</code></strong>；</li> <li><strong>SLB 综合考虑缓存服务器集群中各个节点的资源限制条件、健康度、负载情况等因素，筛选出最优的缓存节点后回应客户端的 HTTP 请求（状态码为 302，重定向地址为最优缓存节点的 IP 地址）</strong>；</li> <li>客户端接收到 SLB 的 HTTP 回复后，重定向到缓存节点上；</li> <li><strong>缓存节点判断请求的资源是否存在、过期，将缓存的资源直接回复给客户端，否则到源站进行数据更新再回复。</strong></li></ul> <p>关键步骤为 6~9，与普通的 DNS 过程不同点是：<strong>需要服务提供者（源站）配置它在其权威 DNS 中的记录，将直接指向源站的 A记录修改为一条 CNAME 记录及其对应的 A记录，CNAME 记录将目标域名转换为 GSLB 的别名，A记录又将该别名转换为 GSLB 的 IP 地址。通过这一系列的操作，将解析源站的目标域名的权力交给了 GSLB，以致于 GSLB 可以根据地理位置等信息将用户的请求引导至距离其最近的 &quot;缓存节点&quot;，减缓了源站的负载压力和网络拥塞。</strong></p> <p>以上介绍了目前 CDN 中最为常见的工作方式，<strong>利用 CNAME 将域名和目标 IP 之间进行解耦，将目标 IP 的解析权下放到 GSLB 中，方便实现更多自定义的功能，是一种更加灵活的方式。</strong></p> <h3 id="cdn-优势"><a href="#cdn-优势" class="header-anchor">#</a> CDN 优势</h3> <ul><li>CDN 节点解决了跨运营商和跨地域访问的问题，访问延时大大降低。</li> <li><strong>大部分请求在 CDN 边缘节点完成，CDN 起到了分流作用，减轻了源服务器的负载。</strong></li></ul> <h3 id="简要概况"><a href="#简要概况" class="header-anchor">#</a> 简要概况</h3> <p><strong>CDN 网络本质是在用户和服务器之间增加 <code>Cache</code> 层，将用户的访问请求引导到 <code>Cache</code> 节点而不是服务器源站点，主要是通过接管 DNS 来实现这一目的的。</strong></p> <h2 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h2> <h3 id="什么是同源策略"><a href="#什么是同源策略" class="header-anchor">#</a> 什么是同源策略</h3> <blockquote><p><strong>同源策略是一个安全策略。所谓同源指的是 协议、域名、端口相同。浏览器出于安全方面的考虑，只允许本域名下的接口交互，不同源的客户端脚本，在没有明确授权的情况下，不能读写对方的资源。</strong></p></blockquote> <p><strong>同源策略限制的内容有：</strong></p> <ul><li>Cookie，LocalStorage，IndexedDB 等存储性内容；</li> <li>DOM 节点</li> <li>AJAX 请求发送后，非同源会被浏览器拦截</li> <li><strong>有三个标签是允许跨域加载资源：<code>&lt;img src=&quot;xxx&quot;&gt;</code>，<code>&lt;link src=&quot;xxx&quot;&gt;</code>，<code>&lt;script src=&quot;xxx&quot;&gt;</code></strong></li></ul> <p><strong>需特别注意：</strong></p> <ul><li><strong>若是协议和端口造成的跨域问题，前端是无能为力的</strong></li> <li><strong>在跨域问题上，仅仅是通过 URL的首部 来识别而不会根据域名对应的 IP地址 是否相同来判断。（URL 首部 可以理解为 &quot;协议、域名、端口必须匹配&quot;）</strong></li> <li><strong>请求跨域了，到底发出去没有？跨域并不是请求发不出去，请求能发出去，服务端能收到请求并正常返回结果，只是结果被浏览器拦截了。</strong></li></ul> <h3 id="cors"><a href="#cors" class="header-anchor">#</a> CORS</h3> <blockquote><p>CORS 需要浏览器和后端同时支持。浏览器会自动进行 CORS 通信，实现 CORS</p></blockquote> <h4 id="简单请求"><a href="#简单请求" class="header-anchor">#</a> 简单请求</h4> <blockquote><p>不会触发 CORS 预检请求</p></blockquote> <ul><li>请求方法为 <code>GET、HEAD、POST</code> 时发的请求</li> <li>人为设置了规范集合之内的首部字段，如：<code>Accept/Accept-Language/Content-Language/Content-Type/DPR/Downlink/Save-Data/Viewport-Width/Width</code></li> <li><code>Content-Type</code> 的值仅限于下列三者之一，即 <code>application/x-www-form-urlencoded、multipart/form-data、text/plain</code></li> <li>请求中的任意 XMLHttpRequestUpload 对象均没有注册任何事件监听器</li> <li>请求中没有使用 ReadableStream 对象。</li></ul> <h4 id="复杂请求（非简单请求）"><a href="#复杂请求（非简单请求）" class="header-anchor">#</a> 复杂请求（非简单请求）</h4> <blockquote><p><strong>浏览器必须首先使用 OPTIONS 方法发起一个预检请求（preflight request），从而获知服务端是否允许该跨域请求。服务器确认允许之后，才发起实际的 HTTP 请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证（包括 Cookies 和 HTTP 认证相关数据）。</strong></p></blockquote> <p><strong>需预检的请求要求必须首先使用 <code>OPTIONS</code> 方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。预检请求的使用：可以避免跨域请求对服务器的用户数据产生未预期的影响。</strong></p> <h4 id="请求附带身份凭证-cookies"><a href="#请求附带身份凭证-cookies" class="header-anchor">#</a> 请求附带身份凭证 ---&gt; cookies</h4> <p><strong>若发起请求时设置 <code>withCredentials</code> 标志设置为 <code>true</code>，从而向服务器发送 cookie。但是如果服务器端的响应中未携带 <code>Access-Control-Allow-Credentials: true</code>，浏览器将不会把响应内容返回给请求的发送者。</strong></p> <p><strong>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin</code> 的值为 <code>*</code>，必须是某个具体的域名。</strong></p> <p>注意，简单 GET 请求不会被预检；若对此类带有身份凭证请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页。</p> <h3 id="node-正向代理"><a href="#node-正向代理" class="header-anchor">#</a> Node 正向代理</h3> <blockquote><p>代理的思路为：<strong>同源策略是浏览器需要遵循的标准，而如果是服务器向服务器请求则无需遵循同源策略。</strong></p></blockquote> <p>脚手架实现跨域原理：<strong>都有着共同的底层包 <a href="https://github.com/chimurai/http-proxy-middleware" target="_blank" rel="noopener noreferrer">http-proxy-middleware<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>（<a href="https://github.com/hua1995116/proxy" target="_blank" rel="noopener noreferrer">http-proxy-middleware 原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</strong></p> <ul><li>接受客户端请求</li> <li><strong>代理服务器将请求转发给服务器</strong></li> <li>拿到服务器响应数据</li> <li>将响应转发给客户端</li></ul> <h3 id="nginx-反向代理"><a href="#nginx-反向代理" class="header-anchor">#</a> Nginx 反向代理</h3> <blockquote><p><strong>通过反向代理的方式，在众多解决跨域方式中都不可避免的需要服务端支持，使用 Nginx 可以纯前端解决请求跨域的问题。</strong></p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>server
<span class="token punctuation">{</span>
  listen <span class="token number">3002</span><span class="token punctuation">;</span>
  server_name localhost<span class="token punctuation">;</span>
  location <span class="token operator">/</span>ok <span class="token punctuation">{</span>
    proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3000</span><span class="token punctuation">;</span>
    
    # 指定允许跨域的方法，<span class="token operator">*</span> 代表所有
    add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Methods <span class="token operator">*</span><span class="token punctuation">;</span>
    
    # 预检命令的缓存，如果不缓存每次会发送两次请求
    add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Max<span class="token operator">-</span>Age <span class="token number">3600</span><span class="token punctuation">;</span>
    # 带cookie请求需要加上这个字段，并设置为 <span class="token boolean">true</span>
    add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials <span class="token boolean">true</span><span class="token punctuation">;</span>
    
    # 表示允许这个域跨域调用（客户端发送请求的域名和端口）
    # $http_origin 动态获取请求客户端请求的域   不用 <span class="token operator">*</span> 的原因是带 cookie 的请求不支持 <span class="token operator">*</span> 号
    add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin $http_origin<span class="token punctuation">;</span>
    
    # 表示请求头的字段 动态获取
    add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Headers
    $http_access_control_request_headers<span class="token punctuation">;</span>
    
    # <span class="token constant">OPTIONS</span> 预检命令，预检命令通过时才发送请求
    # 检查请求的类型是不是预检命令
    <span class="token keyword">if</span> <span class="token punctuation">(</span>$request_method <span class="token operator">=</span> <span class="token constant">OPTIONS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="jsonp"><a href="#jsonp" class="header-anchor">#</a> JSONP</h3> <blockquote><p><code>JSONP</code> 主要利用了 <code>script</code> 标签没有跨域限制的这个特性来完成的。</p></blockquote> <h4 id="使用限制"><a href="#使用限制" class="header-anchor">#</a> 使用限制</h4> <p><strong>仅支持 <code>GET</code> 方法，若想使用完整的 REST 接口，请使用 CORS 或者其他代理方式。</strong></p> <h4 id="流程解析"><a href="#流程解析" class="header-anchor">#</a> 流程解析</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 后端实现</span>
<span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/api/jsonp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cb<span class="token punctuation">,</span> msg <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 前端实现</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script
	src<span class="token operator">=</span><span class="token string">&quot;http://localhost:8080/api/jsonp?msg=hello&amp;cb=jsonpCallback&quot;</span>
	type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="websocket"><a href="#websocket" class="header-anchor">#</a> Websocket</h3> <blockquote><p>Websocket 规范定义了一种 API，可在网络浏览器和服务器之间建立 &quot;套接字&quot; 连接。<strong>客户端和服务器之间存在持久的连接，而且双方都可以随时开始发送数据。这种方式本质没有使用 HTTP，因此也没有跨域的限制。</strong></p></blockquote> <p><a href="https://www.html5rocks.com/zh/tutorials/websockets/basics/" target="_blank" rel="noopener noreferrer">Websocket 详细教程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>WebSocket 协议本质是一个基于 TCP 的协议，为了建立一个 WebSocket 连接，客户端浏览器 首先要向服务器发起一个 HTTP 请求，这个请求和通常的 HTTP 请求不同，包含了一些附加头信息，其中<strong>附加头信息 <code>Upgrade: WebSocket</code> 表明这是一个申请协议升级的 HTTP 请求</strong>，服务器端解析这些附加的头信息然后产生应答信息返回给客户端，客户端和服务器端的 WebSocket 连接就建立起来了，双方可以通过这个连接通道自由的传递信息，并且<strong>这个连接会持续存在直到客户端或者服务器端的某一方主动的关闭连接。</strong></p> <h2 id="正向代理与反向代理"><a href="#正向代理与反向代理" class="header-anchor">#</a> 正向代理与反向代理</h2> <blockquote><p>两者区别在于代理的对象不一样：<strong>正向代理代理的对象是客户端，反向代理代理的对象是服务端。</strong></p></blockquote> <h3 id="了解代理"><a href="#了解代理" class="header-anchor">#</a> 了解代理</h3> <p>**代理本质上是一个服务器，可以类比为一个中介，A 和 B 本来可以直连，中间插入一个 C，C 就是中介。**拿买房为例，买家和卖家原本可以直接交流，但如果卖家把卖房事宜委托给中介后，买家都只能先通过中介来联系卖家，再由中介转述回买家。</p> <h3 id="正向代理（多指-vpn）"><a href="#正向代理（多指-vpn）" class="header-anchor">#</a> 正向代理（多指 VPN）</h3> <blockquote><p><strong>隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都由代理服务器代替来请求。</strong></p></blockquote> <p><img src="https://i.loli.net/2020/06/02/JGTfOviCp1kbFcE.png" alt="正向代理"></p> <p>国内用户想要访问 Google 时，会被阻挡。所以此时把请求发送到另一个代理服务器（可以访问 Google 的服务器）上，由其代为转发请求和接收响应内容。</p> <p>当出现多个请求客户端时，如下：</p> <p><img src="https://i.loli.net/2020/06/02/aFRZHh3eYgEWCXc.png" alt=""></p> <p><strong>正向代理：指一对一或多对一，Server 不知道请求的 Client 都是谁。</strong></p> <p><strong>正向代理是一个位于客户端和原始服务器（origin server）之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标（原始服务器），然后代理向原始服务器转交请求并将获得的内容返回给客户端。客户端必须要进行一些特别的设置才能使用正向代理。</strong></p> <h3 id="正向代理用途"><a href="#正向代理用途" class="header-anchor">#</a> 正向代理用途</h3> <ul><li>访问原理无法访问的资源，如 Google</li> <li>可以做缓存，加速访问资源</li> <li>对客户端访问授权，上网进行认证</li> <li>代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息</li></ul> <h3 id="反向代理（nginx）"><a href="#反向代理（nginx）" class="header-anchor">#</a> 反向代理（Nginx）</h3> <blockquote><p><strong>反向代理隐藏了真实的服务端，当请求 <code>baidu.com</code> 时，背后可能有成千上万台服务器为我们服务，但具体是哪一台，用户不知道也不需要知道，只需要知道反向代理服务器是谁就好了，<code>baidu.com</code> 就是反向代理服务器，反向代理服务器会把请求转发到真实的服务器那里去。</strong></p></blockquote> <p><img src="https://i.loli.net/2020/06/02/G2EfutmSOANkXg4.png" alt="反向代理"></p> <p>反向代理跟正向代理相反，<strong>同时反向代理一般是负载均衡的一个原理（大部分访问量大的网站，如百度，都会做负载均衡，其中反向代理服务器起着至关重要的角色，同时反向代理服务器对应高并发的能力也必须很强）。</strong></p> <p><img src="https://i.loli.net/2020/06/02/jyBFTqk2OVCJQmE.png" alt="反向代码"></p> <h2 id="https-原理"><a href="#https-原理" class="header-anchor">#</a> HTTPS 原理</h2> <p><img src="https://i.loli.net/2020/06/08/EyMBRiSk3FgDNzU.png" alt=""></p> <p><img src="https://i.loli.net/2020/06/08/X2QUbHI8PnmK4wC.png" alt=""></p> <p><img src="https://i.loli.net/2020/06/08/WkhK9es3rIdTxLU.png" alt=""></p> <p><img src="https://i.loli.net/2020/06/08/MxtdqKHQTDRXJfZ.png" alt=""></p> <p><img src="https://i.loli.net/2020/06/08/YjfFnIJxrazgDLd.png" alt=""></p> <h2 id="options-请求的理解"><a href="#options-请求的理解" class="header-anchor">#</a> options 请求的理解</h2> <h3 id="什么是-options-请求"><a href="#什么是-options-请求" class="header-anchor">#</a> 什么是 options 请求</h3> <blockquote><p>HTTP 的 OPTIONS 方法：<strong>用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为 &quot;*&quot;）使用该方法。</strong></p></blockquote> <p>在跨域的情况下，在浏览器发起“复杂请求”时主动发起的。<strong>跨域共享标准规范要求：对那些可能对服务器数据产生副作用的 HTTP 请求方法（特别是 GET 以外的 HTTP 请求，或者搭配某些 MIME 类型的 POST 请求），浏览器必须首先使用 OPTIONS 方法发起一个预检请求（preflight request），从而获知服务端是否允许该跨域请求。服务器确认允许之后，才发起实际的 HTTP 请求。</strong></p> <h3 id="options-关键的请求头字段"><a href="#options-关键的请求头字段" class="header-anchor">#</a> options 关键的请求头字段</h3> <p><strong><code>request header</code> 的关键字段</strong></p> <table><thead><tr><th>关键字段</th> <th>作用</th></tr></thead> <tbody><tr><td>Access-Control-Request-Method</td> <td>告知服务器，实际请求将使用 POST 方法</td></tr> <tr><td>Access-Control-Request-Headers</td> <td>告知服务器，实际请求将携带的自定义请求首部字段</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// example</span>
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Request<span class="token operator">-</span>Method<span class="token operator">:</span> <span class="token constant">POST</span>
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Request<span class="token operator">-</span>Headers<span class="token operator">:</span> <span class="token constant">X</span><span class="token operator">-</span><span class="token constant">PINGOTHER</span><span class="token punctuation">,</span> Content<span class="token operator">-</span>Type
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="options-请求优化"><a href="#options-请求优化" class="header-anchor">#</a> Options 请求优化</h3> <blockquote><p>当发起跨域请求时，若是简单请求，只会发出一次请求。但如果是复杂请求则先发出 options 请求，用于确认目标资源是否支持跨域，然后浏览器会根据服务端响应的 header 自动处理剩余的请求。若响应支持跨域，则继续发出正常请求；若不支持，则在控制台显示错误。</p></blockquote> <p>存在的问题：<strong>触发预检时，跨域请求便会发送 2 次请求，既增加了请求数，也延迟了请求真正发起的时间，严重影响性能。</strong></p> <p>优化 Options 请求的两种方法：</p> <ul><li>转为简单请求，如用  JSONP 做跨域请求</li> <li><strong>对 options 请求进行缓存，服务端设置 <code>Access-Control-Max-Age</code> 字段，当第一次请求该 URL 时会发出 OPTIONS 请求，浏览器会根据返回的 <code>Access-Control-Max-Age</code> 字段缓存该请求的 OPTIONS 预检请求的响应结果（具体缓存时间还取决于浏览器的支持的默认最大值，取两者最小值，一般为 10 分钟）。在缓存有效期内，该资源的请求（URK 和 header 字段都相同的情况下）不会再触发预检。</strong></li></ul> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p><strong>options 请求就是预检请求，可用于检测服务器允许的 http 方法。当发起跨域请求时，由于安全原因，触发一定条件时浏览器会在正式请求之前自动先发起 OPTIONS 请求，即 CORS 预检请求，服务器若接受该跨域请求，浏览器才继续发起正式请求。</strong></p> <h2 id="http状态码301与302的区别"><a href="#http状态码301与302的区别" class="header-anchor">#</a> Http状态码301与302的区别</h2> <h3 id="什么是301重定向？"><a href="#什么是301重定向？" class="header-anchor">#</a> 什么是301重定向？</h3> <p>301重定向表示<strong>本网页永久性转移到另一个地址。SEO常用的招式，会把旧页面的PR等信息转移到新页面。</strong></p> <h3 id="什么是302重定向？"><a href="#什么是302重定向？" class="header-anchor">#</a> 什么是302重定向？</h3> <p>302重定向表示临时性转移，当一个网页URL需要短期变换时使用。</p> <h3 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h3> <ul><li><strong>301重定向是永久的重定向，搜索引擎在抓取新内容的同时也将旧的网站替换为重定向之后的网址。</strong></li> <li><strong>302重定向是临时重定向，搜索引擎会抓取新的内容而保留旧的网址。因为服务器返回302代码，搜索引擎认为新的网址只是暂时的。</strong></li></ul> <p><strong>301 意味着客户端可以对结果进行缓存，搜索引擎或者浏览器都可以把跳转后的地址缓存下来，下一次不必发送这个请求。302 就是客户端必须请求原链接。</strong></p> <h1 id="questions"><a href="#questions" class="header-anchor">#</a> Questions</h1> <h2 id="为什么-http1-1-不能实现多路复用"><a href="#为什么-http1-1-不能实现多路复用" class="header-anchor">#</a> 为什么 HTTP1.1 不能实现多路复用</h2> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://juejin.im/post/5eb7f811f265da7bbc7cc5bd" target="_blank" rel="noopener noreferrer">图解 HTTP 缓存<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/55623075" target="_blank" rel="noopener noreferrer">图解HTTP缓存控制之max-age=0、no-cache、no-store区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5c4528a6f265da611a4822cc" target="_blank" rel="noopener noreferrer">实践这一次,彻底搞懂浏览器缓存机制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/LuckyWinty/fe-weekly-questions/issues/3" target="_blank" rel="noopener noreferrer">http2/http3协议有什么优劣<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/entry/5981c5df518825359a2b9476" target="_blank" rel="noopener noreferrer">HTTP1.0、HTTP1.1和HTTP2.0的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://segmentfault.com/a/1190000022522349" target="_blank" rel="noopener noreferrer">web 下的性能优化1（网络方向）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5d105e1af265da1b71530095" target="_blank" rel="noopener noreferrer">CDN 原理解析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://yq.aliyun.com/articles/104041" target="_blank" rel="noopener noreferrer">CDN 的基本原理和基础架构<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/44966787" target="_blank" rel="noopener noreferrer">CDN 加速原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://mp.weixin.qq.com/s/Nk8YPYQDUJOKgQ9Qa7byag" target="_blank" rel="noopener noreferrer">10种跨域解决方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/25707362" target="_blank" rel="noopener noreferrer">正向代理与反向代理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/anker/p/6056540.html" target="_blank" rel="noopener noreferrer">正向代理与反向代理总结<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5e6c58b06fb9a07ce01a4199" target="_blank" rel="noopener noreferrer">跨域总结：从CORS到Nginx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/amandakelake/blog/issues/62" target="_blank" rel="noopener noreferrer">CORS 简单请求+预检请求<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/youngwind/blog/issues/108" target="_blank" rel="noopener noreferrer">图解 HTTPS: Charles 捕获 HTTPS 的原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/winwill2012/article/details/71774469" target="_blank" rel="noopener noreferrer">HTTPS原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5edef7b2e51d45784213ca24" target="_blank" rel="noopener noreferrer">对 options 请求的理解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5da188aa6fb9a04e1a3bbe80" target="_blank" rel="noopener noreferrer">前端渣渣对DNS的正确理解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5f18683af265da22f84d7602" target="_blank" rel="noopener noreferrer">一文入门DNS？从访问GitHub开始<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/249" target="_blank" rel="noopener noreferrer">Http状态码301和302的应用场景分别是什么？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/43789231" target="_blank" rel="noopener noreferrer">彻底搞懂HTTPS的加密机制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/6844903961506349064" target="_blank" rel="noopener noreferrer">HTTPS 协议是如何保证安全的？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/Internet/Web安全.html">
        Web安全
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c954533f.js" defer></script><script src="/assets/js/2.e9d48de4.js" defer></script><script src="/assets/js/99.9928bacb.js" defer></script>
  </body>
</html>
